<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Lenguaje R para el procesamiento estadístico y gráficos</title>
    <meta charset="utf-8" />
    <meta name="author" content="Carlos Pérez González" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/rutgers-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/ninjutsu.css" rel="stylesheet" />
    <link rel="stylesheet" href="css\custom_css.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Lenguaje R para el procesamiento estadístico y gráficos
## Gráficos básicos en R
### Carlos Pérez González
### Dept. Matemáticas, Estadística e IO, Universidad de La Laguna

---




# Visualización básica

* En R hay una serie de gráficas básicas que podemos obtener de forma sencilla
   + Histograma
   + Gráfico de barras
   + Gráfico de cajas
   + Gráfico de líneas
   + Gráfico de dispersión
  
&lt;div &gt;
  &lt;div &gt;
    &lt;img src="img/R_chart_histograma.png" width="25%" alt="Histograma"/&gt;
    &lt;img src="img/R_chart_barplot.png" width="25%" alt="Gráfico de barras"/&gt;
     &lt;img src="img/R_chart_line.png" width="25%" alt="Gráfico de líneas"/&gt;
  &lt;/div&gt;
  &lt;div &gt;
        &lt;img src="img/R_chart_scatterplot.png" width="25%" alt="Gráfico de dispersión"/&gt;
        &lt;img src="img/R_chart_boxplot.png" width="25%" alt="Gráfico de cajas"/&gt;
  &lt;/div&gt;
&lt;/div&gt;


---

# Visualización básica: Las librerías graphics y lattice

* La librería `graphics` se carga por defecto cuando se comienza una sesión de R. 

* Sin embargo, existe diferentes alternativas en R que nos ayudarán a obtener gráficos con mayor nivel de complejidad.

* En este sentido, la librería `lattice` nos ofrece alternativas a cada uno de los gráficos básicos con `graphics`.

* En estas librerías disponemos de los siguientes métodos para realizar las gráficas que hemos comentado:
   + Para representar un histograma tenemos las funciones `hist` o `histogram`
   + El gráfico de barras se obtiene con `barplot` o `barchart`
   + Un gráfico de cajas lo obtenemos con `boxplot` o `bwplot`
   + Para el gráfico de dispersión utilizaremos `plot`
   
---

# Visualización básica


* Vamos a explicar los gráficos anteriores utilizando un conjunto de datos sobre el sueño en mamíferos y su exposición a peligros durante su descanso.

&lt;table&gt;&lt;tr&gt;
&lt;td&gt;
&lt;img src="img/sleep_giraffe.jpg" alt="Jirafa" width="80%" /&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;img src="img/sleep_cat.jpg" alt="Gato" width="80%" /&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;img src="img/sleep_lion.jpg" alt="León" width="80%" /&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;

---

# Visualización básica

* Las variables son las siguientes
  * especie: especie mamífero
  * peso_cuerpo: peso del cuerpo en kg.
  * peso_cerebro: peso del cerebro en kg.
  * no_suenho: horas de descanso sin sueño
  * suenho: horas de descanso con sueño
  * descanso: tiempo total de descanso (domir) 
  * tiempo_vida: tiempo de vida en años
  * tiempo_gestacion: tiempo de gestación en días
  * predacion: índice de predación (1: menos expuesto a ser depredado - 5: más probable de ser depredado) 
  * exposicion: índice de esposición mientras duerme (1: menos expuesto - 5: más expuesto)
  * peligro: índice de peligro que enfrenta al encarar a otros animales (1: menos peligro de otros animales - 5: más peligro de otros animales).
  




```r
# leer datos de sueño
sleep&lt;-read.table("data/datos_sleep2.txt",header=TRUE,sep="\t",quote="")
```



---

# Visualización básica: histograma (graphics)

* El histogram es el gráfico que nos ayuda a representar los valores de una variable agrupada en intervalos (breaks) y muestra la distribución de frecuencias en estos intervalos. 




```r
hist(sleep$tiempo_vida,col="#8DD3C7",main="Histograma del tiempo de vida")
```

&lt;img src="img/R_histogram.png" alt="Histograma" width="70%" /&gt;

---

# Visualización básica: histograma (graphics)

* Podemos personalizar diferentes características del histograma como los intervalos de clase. Especificando la opción  `freq=TRUE` obtenemos un histograma de frecuencias absolutas.


```r
hist(sleep$tiempo_vida,col="#8DD3C7", freq=TRUE,
     breaks=c(0,20,40,60,80,100),
     xlab="Tiempo de vida",ylab="Frecuencias absolutas",
     main="Histograma del tiempo de vida")
```

&lt;img src="R_curso02_files/figure-html/hist03-1.png" style="display: block; margin: auto;" /&gt;



---

# Visualización básica: histograma (graphics)

* Si queremos agregar una curva de densidad de distribución normal, sólo tenemos que generar
el histograma con la opción `freq=FALSE` y luego añadir con el comando `curve` una curva normal con media y varianza de la variable que estamos representando.

.pull-left[


```r
h1&lt;-hist(sleep$tiempo_vida,col="#8DD3C7", 
         freq=FALSE,
     breaks=c(0,20,40,60,80,100),
     xlab="Tiempo de vida",
     ylab="Densidad de probabilidad",
     main="Histograma del tiempo de vida")
curve(dnorm(x, 
            mean=mean(sleep$tiempo_vida,na.rm=TRUE), 
            sd=sd(sleep$tiempo_vida,na.rm=TRUE)), 
      add=TRUE, col="purple")
```
]


.pull-right[
&lt;img src="R_curso02_files/figure-html/hist06b-1.png" style="display: block; margin: auto;" /&gt;
]






---
class: normal remark-code
# Visualización básica: histograma (graphics)


* Observamos que `hist` retorna no sólo un gráfico sino un objeto lista con diferentes atributos del gráfico.


```r
h1
```

```
## $breaks
## [1]   0  20  40  60  80 100
## 
## $counts
## [1] 36 16  4  1  1
## 
## $density
## [1] 0.031034483 0.013793103 0.003448276 0.000862069 0.000862069
## 
## $mids
## [1] 10 30 50 70 90
## 
## $xname
## [1] "sleep$tiempo_vida"
## 
## $equidist
## [1] TRUE
## 
## attr(,"class")
## [1] "histogram"
```

---

# Visualización básica: histograma (graphics)

* Si queremos representar un histograma de frecuencias relativas tenemos que dividir los `counts` por la suma total.


```r
h1$counts&lt;-h1$counts/sum(h1$counts)
plot(h1,col="#8DD3C7", 
     xlab="Tiempo de vida",ylab="Frecuencias relativas",
     main="Histograma del tiempo de vida")
```

&lt;img src="R_curso02_files/figure-html/hist05-1.png" style="display: block; margin: auto;" /&gt;




---

# Visualización básica: histograma (lattice)

* Como se ha comentado previamente, la librería `lattice` nos puede ayudar a elaborar gráficos más sofisticados, por ejemplo, desagregando por grupos.

* En este caso, se utiliza el comando `histogram(x)` donde `x` es la variable a representar.

.pull-left[


```r
library(lattice)

histogram(sleep$tiempo_gestacion, 
          type ="count",
          xlab="Tiempo de gestación",
          ylab="Frecuencias absolutas",
          main="Histograma del tiempo de vida")
```
]


.pull-right[
&lt;img src="R_curso02_files/figure-html/hist07b-1.png" style="display: block; margin: auto;" /&gt;
]

---

# Visualización básica: histograma (lattice)

* Sin embargo, en `lattice` podemos ejecutar el comando como `histogram(formula,data)` asignando el conjunto de datos en el argumento `data` y especificando las variables en `formula` de la siguiente manera:

  * `~ x | g1 * g2 * ...` : Representamos la variable `x` (numérica) desagregada por las variables `g1`, `g2`, .... (factores) de forma opcional.
  
  * `y ~ x | g1 * g2 * ...` o `x ~ y | g1 * g2 * ...` : Representamos las variable `x` e `y` (numéricas) desagregadas por las variables `g1`, `g2`, .... (factores) de forma opcional.
  
* También se pueden separar los factores `g1`, `g2`, .... mediante `+` en lugar de `*` y el resultado sería el mismo. 




.pull-left[


```r
library(lattice)

histogram(~ tiempo_gestacion, data = sleep,
          type ="count",
          xlab="Tiempo de gestación",
          ylab="Frecuencias absolutas",
          main="Histograma del tiempo de vida")
```
]


.pull-right[
&lt;img src="R_curso02_files/figure-html/hist08b-1.png" style="display: block; margin: auto;" /&gt;
]


---

# Visualización básica: histograma (lattice)

* Veamos cómo hacer el histograma desagrupando de acuerdo a la variable `peligro`


```r
#sleep$peligro&lt;-factor(sleep$peligro)
histogram(~ tiempo_gestacion | peligro, data = sleep,
          type ="count",
          xlab="Tiempo de gestación",ylab="Frecuencias absolutas",
          main="Histograma del tiempo de gestación por nivel de peligro",
          layout=c(2,2))
```

&lt;img src="R_curso02_files/figure-html/hist09-1.png" style="display: block; margin: auto;" /&gt;

# Visualización básica: histograma (lattice)

* Representar un histograma de la variable `descanso` condicionada por el factor `predacion`

&lt;img src="R_curso02_files/figure-html/hist10-1.png" style="display: block; margin: auto;" /&gt;

```r
#sleep$peligro&lt;-factor(sleep$peligro)
histogram(~ ... | ..., data = sleep,
          type ="count",
          xlab="....",ylab="Frecuencias absolutas",
          main="Histograma del ... por ...")
```

---

class: normal remark-code
# Visualización básica: gráfico de barras (graphics)

* El gráfico de barras compara valores de una variable frente a otra de tipo nominal.


.pull-left[



```r
# aggregate es un comando que se utiliza para crear
# tablas desagregadas de acuerdo a variables de una lista
tab_peligro&lt;-aggregate(sleep$peso_cerebro, 
                       list(sleep$peligro), mean,na.rm=TRUE)
colnames(tab_peligro)&lt;-c("peligro","promedio_cerebro")


barplot(promedio_cerebro~peligro,
        data=tab_peligro,
        col="#8DD3C7",
        main="Comparación peso medio cerebro según nivel peligro")
```
]


.pull-right[


&lt;img src="R_curso02_files/figure-html/bar02b-1.png" style="display: block; margin: auto;" /&gt;
]



---


# Visualización básica: gráfico de barras (lattice)

* La librería `lattice` también permite generar gráficos de barras con `barchart`


```r
barchart(promedio_cerebro~peligro,
        data=tab_peligro,
        col="#8DD3C7",main="Comparación del peso medio cerebro según nivel de peligro")
```

&lt;img src="R_curso02_files/figure-html/bar03-1.png" style="display: block; margin: auto;" /&gt;

* En este caso, además, podemos representar las barras en horizontal cambiando la fórmula `promedio_cerebro~peligro` por `peligro~promedio_cerebro`.

---


# Visualización básica: gráfico de barras (lattice)

* También podemos especificar una variable para desagrupar los diagramas de barras


```r
tab_peligro&lt;-aggregate(sleep$peso_cerebro, list(sleep$peligro,sleep$talla), mean,na.rm=TRUE)
colnames(tab_peligro)&lt;-c("peligro","talla","promedio_cerebro")

barchart(promedio_cerebro~peligro | talla ,
        data=tab_peligro,
        col="#8DD3C7",main="Comparación del peso medio cerebro según nivel de peligro por talla del animal")
```

&lt;img src="R_curso02_files/figure-html/bar04-1.png" style="display: block; margin: auto;" /&gt;

* __IMPORTANTE__: Recordar que puede se necesario convertir a variable factor y ordenar los niveles antes de generar las tablas y los gráficos

```r
sleep$talla&lt;-factor(sleep$talla,levels=c("little size", "normal size","large size"))
# repetir las instrucciones de la tabla y el gráfico
```

---


# Visualización básica: gráfico de barras (lattice)

* Representar ahora en diagrama de barras el peso del cerebro frente al nivel de peligro desagregado por talla del animal y nivel de riesgo de predacion
&lt;img src="R_curso02_files/figure-html/bar06-1.png" style="display: block; margin: auto;" /&gt;

```r
tab_peligro&lt;-aggregate(sleep$..., list(sleep$peligro,...,...), mean,na.rm=TRUE)
colnames(tab_peligro)&lt;-c("peligro","...","...","promedio_cerebro")

barchart(...~peligro | ... ,
        data=tab_peligro,
        col="#8DD3C7",main="Comparación del peso medio cerebro según nivel de peligro por ...")
```

---

# Visualización básica: gráfico de cajas (graphics)

* El gráfico de cajas es uno de los gráficos más ampliamente utilizados para ver la forma de la distribución de una variable y la posible presencia de valores atípicos. Vamos a verlo con la variable descanso.




```r
boxplot(sleep$descanso, 
        ylab = 'Descanso (en horas)',      # Adds label to y-axis
        col="#8DD3C7",                     # Adds colour
        ylim = c(0,30),                   # Changes axis limits
        main = "Boxplot de horas de descanso")  # Adds title
```

&lt;img src="R_curso02_files/figure-html/cajas02-1.png" style="display: block; margin: auto;" /&gt;

---


# Visualización básica: gráfico de cajas (lattice)

* Representar el gráfico de tiempo de descanso comparando el nivel de peligro, y desagrupando por talla, mediante el comando `bwplot` de `lattice`.


```r
bwplot(...~peligro | ..., data=sleep, 
        xlab = '...',                  # Adds label to x-axis
        ylab = '...',                  # Adds label to y-axis
        col="#8DD3C7",                 # Adds colour
        main = "Boxplot de horas de descanso según nivel de peligro por ....")  # Adds title        
```
&lt;img src="R_curso02_files/figure-html/cajas04b-1.png" style="display: block; margin: auto;" /&gt;
---

# Visualización básica: gráfico de líneas (el comando plot)

* El gráfico de líneas es idóneo para analizar tendencias o cambios relativos en las cantidades en los datos a lo largo del tiempo (o de cualquier otra variable).




```r
sleep_dep&lt;-read.table("data/datos_sleep_deporte.csv",header=TRUE)
sleep_dep$dia&lt;-as.Date(sleep_dep$dia,format="%d-%b-%y")

plot(sleep_dep$dia,sleep_dep$dormido ,col="blue",
     main="Evolución del descanso según día",
     xlab="Día",
     ylab="Descanso",
     type="l")
```

&lt;img src="R_curso02_files/figure-html/line03-1.png" style="display: block; margin: auto;" /&gt;



---

# Visualización básica: gráfico de dispersión (el comando plot)

* Como se acaba de ver, el comando `plot` permite obtener un sencillo gráfico de líneas. Pero este comando admite bastantes opciones personalizadas cuando lo utilizamos para gráficos de dispersión. 

```r
plot(sleep$suenho,sleep$descanso ,col="blue",
     main="Relación entre sueño y tiempo total de descanso",
     xlab="Tiempo de sueño",
     ylab="Descanso")
```

&lt;img src="R_curso02_files/figure-html/scatter01-1.png" style="display: block; margin: auto;" /&gt;

---

# Visualización básica: gráfico de dispersión (el comando plot)

* Existen varios argumentos de `plot` que pueden ser muy interesantes para mejorar el gráfico.
  * __tipo de punto__: Se configura con el argumento `pch` de plot (ayuda en ?points)
  &lt;img src="R_curso02_files/figure-html/plot01-1.png" style="display: block; margin: auto;" /&gt;
  * __tipo de línea__: Se configura con el argumento `lty` de plot (ayuda en ?points)
  
  
  &lt;img src="R_curso02_files/figure-html/plot02-1.png" style="display: block; margin: auto;" /&gt;

---

# Visualización básica: gráfico de dispersión (el comando plot)

* También podemos cambiar otros atributos: 
* `cex`: argumento para controlar el __tamaño del punto__ (valor por defecto a 1).
* `lwd`: argumento para controlar el __grosor de línea__ (valor por defecto a 1).
* `col`: argumento para controlar el __color__ (ayuda en ?colors)

&lt;img src="R_curso02_files/figure-html/plot03-1.png" style="display: block; margin: auto;" /&gt;


---

# Visualización básica: gráfico de dispersión (el comando plot)

* Representar las variable `peso_cerebro` frente a `tiempo_vida` con algún color, tipo de punto 20 y tamaño del punto a 1.5:


```r
plot(sleep$...,sleep$... ,col="...",pch=...,cex=...,
     main="Relación entre peso de cerebro y tiempo de vida",
     xlab="Peso de cerebro (kg.)",
     ylab="Tiempo de vida (años)")
```
&lt;img src="R_curso02_files/figure-html/scatter03-1.png" style="display: block; margin: auto;" /&gt;


---

# Visualización básica: gráfico de dispersión (el comando plot)

* Podemos incluir elementos en un gráfico utilizando una combinación de instrucciones.

* Por ejemplo, si queremos añadir una línea al gráfico hacemos los siguiente con el comando `abline` al que le podemos pasar los argumentos ´h´ o ´v´ para un línea horizontal o vertical, respectivamente:

.pull-left[



```r
plot(sleep$suenho,sleep$descanso ,col="blue",pch=20,
     main="Relación entre sueño y tiempo total de descanso",
     xlab="Tiempo de sueño",
     ylab="Descanso")
abline(v=sleep$suenho[sleep$especie=="..."],
       col="red",lty="dashed")
abline(h=sleep$descanso[sleep$especie=="..."],
       col="red",lty="dashed")
```
]


.pull-right[

&lt;img src="R_curso02_files/figure-html/scatter04b-1.png" style="display: block; margin: auto;" /&gt;
]


---

# EJERCICIO: Gráfico con el comando plot

* En los E.E.U.U. suele ser habitual la realización de sondeos para conocer la valoración de los presidentes entrre los ciudadanos (`approval ratings`)

&lt;center&gt;
&lt;img src="img/Blair-Bush-Aznar-Azores-Irak.jpg" alt="Bush y amigos" width="35%" /&gt;
&lt;/center&gt;


```r
bush&lt;-read.csv("data/data_bush.csv")
bush$fecha&lt;-as.Date(bush$fecha)
bush&lt;-bush[bush$agencia=="gallup",]
```

* Realizar un gráfico para representar la evolución en el tiempo del rating de Bush 



---

# SOLUCIÓN EJERCICIO: Gráfico con el comando plot

* En los E.E.U.U. suele ser habitual la realización de sondeos para conocer la valoración de los presidentes entrre los ciudadanos (`approval ratings`)

&lt;center&gt;
&lt;img src="img/Blair-Bush-Aznar-Azores-Irak.jpg" alt="Bush y amigos" width="35%" /&gt;
&lt;/center&gt;


.pull-left[


```r
bush&lt;-read.csv("data/data_bush.csv")
bush$fecha&lt;-as.Date(bush$fecha)
bush&lt;-bush[bush$agencia=="gallup",]


with(bush,plot(fecha,rating,type="o",pch=20,col="blue"))
fechas&lt;-as.Date(c("2001-09-11","2003-03-20","2003-12-13"))
abline(v=fechas[1],lty=2,col="red")
abline(v=fechas[2],lty=2,col="red")
abline(v=fechas[3],lty=2,col="red")
text(x=fechas[1]-30, y=80, labels="11-S")
text(x=fechas[2]-30, y=80, labels="Invasión Irak")
text(x=fechas[3]-30, y=80, labels="Captura S. Hussein")
```
]


.pull-right[

![](R_curso02_files/figure-html/exe02sol-1.png)&lt;!-- --&gt;
]


---

# Visualización básica: algunos comandos de utilidad

* Se puede comprobar en lo que hemos visto hasta el momento que hay algunos comandos (por ejemplo, de la librería `lattice`) que nos permite especiificar el argumento `data` y luego sólo hay que especificar las variables sin necesidad de especificar `data$...`.

* En otros comandos (como `hist` y `plot`) esto no es así y habría que especificar `data$...` para referirnos a las variables.

* Una posible solución sería utilizar el comando `attach`, que crea una copia en memoria de las variables de un dataset y así referirnos a ellas directamente por el nombre.

```r
attach(sleep)
plot(peso_cerebro,tiempo_vida)
```

---

# Visualización básica: algunos comandos de utilidad

* Otra alternativa sería el comando with que permite anteponer el nombre de un dataset antes de la ejecución de un comando dado.

```r
with(sleep, 
     plot(peso_cerebro,tiempo_vida)
)

with(sleep, 
     hist(peso_cerebro)
)
```

* Esta última alternativa es más clara ya que permite ver en todo momento a qué dataset pertenecen las variables.



---

# Visualización básica: gráfico de dispersión (el comando plot)

* Vamos a añadir una recta de regresión lineal de `descanso` frente a `suenho` ajustando primero el modelo lineal con el comando `lm(formula, data)`:

```r
linreg&lt;-lm(...~...,data=sleep)
linreg
```


```
## 
## Call:
## lm(formula = descanso ~ suenho, data = sleep)
## 
## Coefficients:
## (Intercept)       suenho  
##       6.027        2.305
```


---

# Visualización básica: gráfico de dispersión (el comando plot)

* Y, ahora, podemos utilizar el argumento `reg` del comando `plot`:

```r
with(sleep,
     plot(suenho,descanso ,col="blue",pch=20,
     main="Relación entre sueño y tiempo total de descanso",
     xlab="Tiempo de sueño",
     ylab="Descanso")
)
abline(....,col="blue",lty="dotdash")
```
&lt;img src="R_curso02_files/figure-html/scatter10-1.png" style="display: block; margin: auto;" /&gt;

---

# Visualización básica: gráfico de dispersión (el comando plot)

* Observar que podemos diferenciar por grupos de un factor:

```r
with(sleep,
     plot(suenho,descanso ,col=peligro,pch=20,
     main="Relación entre sueño y tiempo total de descanso",
     xlab="Tiempo de sueño",
     ylab="Descanso")
)
```
&lt;img src="R_curso02_files/figure-html/scatter12-1.png" style="display: block; margin: auto;" /&gt;


---

# Visualización básica: gráfico de dispersión (el comando plot)

* En este gráfico se necesita una leyenda para aclarar a qué grupo pertenece cada color.

* El comando `legend(x,y,...)` nos puede ayudar a colocar una leyenda en unas coordenadas `(x,y)`
o en una de las siguientes posiciones `x`:

&lt;center&gt;
&lt;img src="img/R_legend.png" alt="Leyenda" width="65%" /&gt;
&lt;/center&gt;

---

# Visualización básica: gráfico de dispersión (el comando plot)

* Por tanto, veamos cómo añadir la leyenda:
  * Crear un vector `color_punto` para el color de cada grupo
  * En el argumento `col` de `plot` hay que especificar un vector con los colores de cada punto. Dicho vector es de la forma `color_punto[talla]`
  * Finalmente, especificar la leyenda en un lugar adecuado del gráfico y especificar en `levels` los niveles de la variable de grupo, es decir, `levels(talla)`, y en `col` el color que ha de tener cada valor de la leyenda.


```r
color_punto&lt;-c("...","...","...") # especificar el color deseado 
                                  # para cada nivel de peligro
with(sleep,
     plot(suenho,descanso ,col=...,pch=20,   # especificar el vector de colores 
                                             # de cada punto
          main="Relación entre sueño y tiempo total de descanso",
          xlab="Tiempo de sueño",
          ylab="Descanso")
)
with(sleep,
     legend("bottomright",pch=20,
            legend=...,
            col=...))
```

---

# Visualización básica: gráfico de dispersión (el comando plot)

* El resultado final:

&lt;img src="R_curso02_files/figure-html/scatter14-1.png" style="display: block; margin: auto;" /&gt;


---

# Visualización básica: gráfico de dispersión (el comando plot)

* Representar las variable `tiempo_gestacion` frente a `tiempo_vida` diferenciado por colores en los grupos de la variable `peligro`, tipo de punto 20 y tamaño del punto a 1.5:


```r
color_punto&lt;-c("...","...","...")
with(...,
     plot(..., ... , col=..., pch=..., cex=...,
          main="Relación entre .... y ...",
          xlab="...",
          ylab="...")
     )
with(...,
     legend("bottomright",pch=20,
            legend=levels(...),
            col=...
            )
     )
```




---

# Visualización básica: gráfico de puntos (lattice)

* En `lattice` podemos encontrar la función `xyplot` para representar un gráfico de dispersion



&lt;img src="R_curso02_files/figure-html/scatter18-1.png" style="display: block; margin: auto;" /&gt;

---

# Visualización básica: gráfico de puntos (lattice)

* Hay otros tipos de gráficos de puntos que pueden ser interesantes




```r
sleep_little&lt;-subset(sleep,talla=="little size")
dotplot(especie~descanso,  
 data = sleep_little,
 pch = 20)
```

&lt;img src="R_curso02_files/figure-html/scatter20-1.png" style="display: block; margin: auto;" /&gt;

* Este gráfico es interesante si añadimos una ordenación por la variable que especificamos en el eje x. Para ello, cambiar `especie~descanso` por `reorder(especie,descanso)~suenho+descanso`


---

# Visualización básica: gráfico de puntos (lattice)

* En el gráfico de puntos se pueden incluir múltiples variables en la representación. Añadir la variable `suenho` a `descanso` en la representación




```r
dotplot(...~...+descanso,  
 data = sleep_little,
 pch = 20)
```
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
